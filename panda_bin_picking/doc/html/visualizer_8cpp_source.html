<html><head><meta http-equiv="Content-Type" content="text/html;charset=utf-8">
<title>panda_bin_picking: visualizer.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
<script type="text/javascript" src="jquery.js"></script>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',false,false,'search.php','Search');
});
</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">visualizer.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="visualizer_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="visualizer_8h.html">visualizer.h</a>&quot;</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="preprocessor">#include &lt;eigen_conversions/eigen_msg.h&gt;</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;</div><div class="line"><a name="l00005"></a><span class="lineno"><a class="line" href="visualizer_8cpp.html#ad86358bf19927183dd7b4ae215a29731">    5</a></span>&#160;<span class="preprocessor">#define COLOR_RED   Eigen::Vector4f(1.0f, 0.0f, 0.0f, 0.5f)</span></div><div class="line"><a name="l00006"></a><span class="lineno"><a class="line" href="visualizer_8cpp.html#afc9149f5de51bd9ac4f5ebbfa153f018">    6</a></span>&#160;<span class="preprocessor">#define COLOR_GREEN Eigen::Vector4f(0.0f, 1.0f, 0.0f, 0.5f)</span></div><div class="line"><a name="l00007"></a><span class="lineno"><a class="line" href="visualizer_8cpp.html#a23c70d699a5a775bc2e1ebeb8603f630">    7</a></span>&#160;<span class="preprocessor">#define COLOR_BLUE  Eigen::Vector4f(0.0f, 0.0f, 1.0f, 0.5f)</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;</div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;ros::Publisher <a class="code" href="classVisualizer.html#a4f62c8d276bab5c3eb17286c24ade8df">Visualizer::pub_vis_</a>;</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;moveit_visual_tools::MoveItVisualToolsPtr <a class="code" href="classVisualizer.html#a1b17f39ec85ad5238d414f18f609325b">Visualizer::visual_tools_</a>;</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;</div><div class="line"><a name="l00012"></a><span class="lineno"><a class="line" href="classVisualizer.html#ad87e03ba0bb411c177f85f919ad48576">   12</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classVisualizer.html#ad87e03ba0bb411c177f85f919ad48576">Visualizer::init</a>(ros::NodeHandle&amp; node_handle)</div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;{</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;    <span class="comment">// setup visualization publisher</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;    <a class="code" href="classVisualizer.html#a4f62c8d276bab5c3eb17286c24ade8df">pub_vis_</a> = node_handle.advertise&lt;visualization_msgs::MarkerArray&gt;(<span class="stringliteral">&quot;/panda_bin_picking/visualization&quot;</span>, 1);</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;    </div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;    <span class="comment">// setup moveit visual tools</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;    <a class="code" href="classVisualizer.html#a1b17f39ec85ad5238d414f18f609325b">visual_tools_</a> = std::make_shared&lt;moveit_visual_tools::MoveItVisualTools&gt;(<span class="stringliteral">&quot;world&quot;</span>);</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;}</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;</div><div class="line"><a name="l00021"></a><span class="lineno"><a class="line" href="classVisualizer.html#a5f586c3b071c50a15c4ccafeee285ada">   21</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classVisualizer.html#a5f586c3b071c50a15c4ccafeee285ada">Visualizer::plotPose</a>(<span class="keyword">const</span> <a class="code" href="structPose.html">Pose</a>&amp; pose, <span class="keyword">const</span> <span class="keywordtype">double</span> tcp_offset)</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;{</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;    <span class="comment">// translate pose by tcp-offset to visualize pose between gripper fingers</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;    <span class="keyword">const</span> Eigen::Vector3d direction = pose.<a class="code" href="structPose.html#a6fd2cf5eb9fa60e6971f5cc7b7dcbdfd">rotation</a>.col(2).normalized();</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    <a class="code" href="classVisualizer.html#a4f62c8d276bab5c3eb17286c24ade8df">pub_vis_</a>.publish(<a class="code" href="classVisualizer.html#ac19c0f4fae081a121c586066830961cf">createPoseMarkers</a>(pose.<a class="code" href="structPose.html#aae8ae43d254398d6e006032ae4ef72b1">position</a> + tcp_offset*direction, pose.<a class="code" href="structPose.html#a6fd2cf5eb9fa60e6971f5cc7b7dcbdfd">rotation</a>));</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;}</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;</div><div class="line"><a name="l00028"></a><span class="lineno"><a class="line" href="classVisualizer.html#a0b5176ec8358c54968c1738f0555157c">   28</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classVisualizer.html#a0b5176ec8358c54968c1738f0555157c">Visualizer::plotGrasp</a>(<span class="keyword">const</span> <a class="code" href="structPose.html">Pose</a>&amp; pose, <span class="keyword">const</span> <a class="code" href="structHandGeometry.html">HandGeometry</a>&amp; hand_geometry, <span class="keyword">const</span> <span class="keywordtype">double</span> tcp_offset)</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;{</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    <span class="comment">// translate pose to match grasp configuration (reverse the translation fron &quot;FrankaPanda.GraspConfigToPose6D()&quot;)</span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    <span class="keyword">const</span> Eigen::Vector3d direction = pose.<a class="code" href="structPose.html#a6fd2cf5eb9fa60e6971f5cc7b7dcbdfd">rotation</a>.col(2).normalized();</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    <a class="code" href="classVisualizer.html#a4f62c8d276bab5c3eb17286c24ade8df">pub_vis_</a>.publish(<a class="code" href="classVisualizer.html#aa37b51843fc787cc53457015fdcf921c">createGraspMarkers</a>(pose.<a class="code" href="structPose.html#aae8ae43d254398d6e006032ae4ef72b1">position</a> + (tcp_offset-hand_geometry.<a class="code" href="structHandGeometry.html#a73edbc1f059f2b1dbba4d8420f55786a">depth</a>)*direction, pose.<a class="code" href="structPose.html#a6fd2cf5eb9fa60e6971f5cc7b7dcbdfd">rotation</a>*Eigen::AngleAxisd(-M_PI_4, Eigen::Vector3d::UnitZ()), hand_geometry));</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;}</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;</div><div class="line"><a name="l00035"></a><span class="lineno"><a class="line" href="classVisualizer.html#a114a87e73b15235d8149ae3570927ef0">   35</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classVisualizer.html#a114a87e73b15235d8149ae3570927ef0">Visualizer::plotTrajectory</a>(<span class="keyword">const</span> moveit_msgs::RobotTrajectory&amp; traj, <span class="keyword">const</span> robot_model::JointModelGroup* joint_model_group)</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;{</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    <span class="comment">// visualize the trajectory using moveit visual tools</span></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    <a class="code" href="classVisualizer.html#a1b17f39ec85ad5238d414f18f609325b">visual_tools_</a>-&gt;publishTrajectoryLine(traj, joint_model_group);</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    <a class="code" href="classVisualizer.html#a1b17f39ec85ad5238d414f18f609325b">visual_tools_</a>-&gt;trigger();</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;}</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;</div><div class="line"><a name="l00042"></a><span class="lineno"><a class="line" href="classVisualizer.html#acfb5b9aa985915dee7d8c63867e3259d">   42</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classVisualizer.html#acfb5b9aa985915dee7d8c63867e3259d">Visualizer::clear</a>()</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;{</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    <span class="comment">// clear marker arrays</span></div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    visualization_msgs::MarkerArray marker_array;</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    visualization_msgs::Marker marker;</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    marker.action = visualization_msgs::Marker::DELETEALL;</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    marker_array.markers.push_back(marker);</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    <a class="code" href="classVisualizer.html#a4f62c8d276bab5c3eb17286c24ade8df">pub_vis_</a>.publish(marker_array);</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <span class="comment">// clear moveit visual tools</span></div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <a class="code" href="classVisualizer.html#a1b17f39ec85ad5238d414f18f609325b">visual_tools_</a>-&gt;deleteAllMarkers();</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <a class="code" href="classVisualizer.html#a1b17f39ec85ad5238d414f18f609325b">visual_tools_</a>-&gt;trigger();</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;}</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;</div><div class="line"><a name="l00056"></a><span class="lineno"><a class="line" href="classVisualizer.html#ac19c0f4fae081a121c586066830961cf">   56</a></span>&#160;visualization_msgs::MarkerArray <a class="code" href="classVisualizer.html#ac19c0f4fae081a121c586066830961cf">Visualizer::createPoseMarkers</a>(<span class="keyword">const</span> <a class="code" href="custom__types_8h.html#a988d8c32194b27014660c5f772c84896">Position</a>&amp; position, <span class="keyword">const</span> <a class="code" href="custom__types_8h.html#acf357236408d7f2041a5a46d8299f2d1">Rotation</a>&amp; rotation)</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;{</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    <span class="keyword">const</span> visualization_msgs::Marker x = <a class="code" href="classVisualizer.html#a0b07e74574ce90969bf0a78b8ab4124d">createAxisMarker</a>(position, rotation.col(0), <a class="code" href="visualizer_8cpp.html#ad86358bf19927183dd7b4ae215a29731">COLOR_RED</a>, 5, <span class="stringliteral">&quot;world&quot;</span>);</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    <span class="keyword">const</span> visualization_msgs::Marker y = <a class="code" href="classVisualizer.html#a0b07e74574ce90969bf0a78b8ab4124d">createAxisMarker</a>(position, rotation.col(1), <a class="code" href="visualizer_8cpp.html#afc9149f5de51bd9ac4f5ebbfa153f018">COLOR_GREEN</a>, 6, <span class="stringliteral">&quot;world&quot;</span>);</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    <span class="keyword">const</span> visualization_msgs::Marker z = <a class="code" href="classVisualizer.html#a0b07e74574ce90969bf0a78b8ab4124d">createAxisMarker</a>(position, rotation.col(2), <a class="code" href="visualizer_8cpp.html#a23c70d699a5a775bc2e1ebeb8603f630">COLOR_BLUE</a>, 7, <span class="stringliteral">&quot;world&quot;</span>);</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    visualization_msgs::MarkerArray marker_array;</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    marker_array.markers.push_back(x);</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    marker_array.markers.push_back(y);</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    marker_array.markers.push_back(z);</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    <span class="keywordflow">return</span> marker_array;</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;}</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;</div><div class="line"><a name="l00070"></a><span class="lineno"><a class="line" href="classVisualizer.html#a0b07e74574ce90969bf0a78b8ab4124d">   70</a></span>&#160;visualization_msgs::Marker <a class="code" href="classVisualizer.html#a0b07e74574ce90969bf0a78b8ab4124d">Visualizer::createAxisMarker</a>(<span class="keyword">const</span> <a class="code" href="custom__types_8h.html#a988d8c32194b27014660c5f772c84896">Position</a>&amp; origin, <span class="keyword">const</span> <a class="code" href="custom__types_8h.html#a988d8c32194b27014660c5f772c84896">Position</a>&amp; direction, <span class="keyword">const</span> Eigen::Vector4f&amp; color, <span class="keywordtype">int</span> <span class="keywordtype">id</span>, <span class="keyword">const</span> std::string&amp; frame_id)</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;{</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    visualization_msgs::Marker marker;</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    marker.header.frame_id = frame_id;</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    marker.header.stamp = ros::Time();</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    marker.ns = <span class="stringliteral">&quot;axis&quot;</span>;</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    marker.id = id;</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    marker.type = visualization_msgs::Marker::ARROW;</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    marker.action = visualization_msgs::Marker::ADD;</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    marker.points.resize(2);</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    tf::pointEigenToMsg(origin, marker.points[0]);</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    tf::pointEigenToMsg(origin + direction.normalized()/10, marker.points[1]);</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    tf::quaternionEigenToMsg(Eigen::Quaterniond(Eigen::Matrix3d::Identity()), marker.pose.orientation);</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    marker.scale.x = 0.01f;</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    marker.scale.y = 0.02f;</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    marker.scale.z = 0.02f;</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    </div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    marker.color.r = color[0];</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    marker.color.g = color[1];</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    marker.color.b = color[2];</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    marker.color.a = color[3];</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <span class="keywordflow">return</span> marker;</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;}</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;</div><div class="line"><a name="l00098"></a><span class="lineno"><a class="line" href="classVisualizer.html#aa37b51843fc787cc53457015fdcf921c">   98</a></span>&#160;visualization_msgs::MarkerArray <a class="code" href="classVisualizer.html#aa37b51843fc787cc53457015fdcf921c">Visualizer::createGraspMarkers</a>(<span class="keyword">const</span> <a class="code" href="custom__types_8h.html#a988d8c32194b27014660c5f772c84896">Position</a>&amp; position, <span class="keyword">const</span> <a class="code" href="custom__types_8h.html#acf357236408d7f2041a5a46d8299f2d1">Rotation</a>&amp; rotation, <span class="keyword">const</span> <a class="code" href="structHandGeometry.html">HandGeometry</a>&amp; hand_geometry)</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;{</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> hw = 0.5*hand_geometry.<a class="code" href="structHandGeometry.html#a43487c0a1eed3549174d0018257b60d8">outer_diameter</a> - 0.5*hand_geometry.<a class="code" href="structHandGeometry.html#a8001d8123f84378ebb7f9b8b26ddb348">finger_width</a>;</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    </div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <span class="keyword">const</span> Eigen::Vector3d approach = rotation.col(2);</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <span class="keyword">const</span> Eigen::Vector3d binormal = -rotation.col(1);</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <span class="keyword">const</span> Eigen::Vector3d axis = rotation.col(0);</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <span class="keyword">const</span> <a class="code" href="custom__types_8h.html#a988d8c32194b27014660c5f772c84896">Position</a> left_bottom = position - hw * binormal;</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    <span class="keyword">const</span> <a class="code" href="custom__types_8h.html#a988d8c32194b27014660c5f772c84896">Position</a> right_bottom = position + hw * binormal;</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <span class="keyword">const</span> <a class="code" href="custom__types_8h.html#a988d8c32194b27014660c5f772c84896">Position</a> left_top = left_bottom + hand_geometry.<a class="code" href="structHandGeometry.html#a73edbc1f059f2b1dbba4d8420f55786a">depth</a> * approach;</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <span class="keyword">const</span> <a class="code" href="custom__types_8h.html#a988d8c32194b27014660c5f772c84896">Position</a> right_top = right_bottom + hand_geometry.<a class="code" href="structHandGeometry.html#a73edbc1f059f2b1dbba4d8420f55786a">depth</a> * approach;</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    <span class="keyword">const</span> <a class="code" href="custom__types_8h.html#a988d8c32194b27014660c5f772c84896">Position</a> left_center = left_bottom + 0.5*(left_top - left_bottom);</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    <span class="keyword">const</span> <a class="code" href="custom__types_8h.html#a988d8c32194b27014660c5f772c84896">Position</a> right_center = right_bottom + 0.5*(right_top - right_bottom);</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <span class="keyword">const</span> <a class="code" href="custom__types_8h.html#a988d8c32194b27014660c5f772c84896">Position</a> base_center = left_bottom + 0.5*(right_bottom - left_bottom) - 0.01*approach;</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    <span class="keyword">const</span> <a class="code" href="custom__types_8h.html#a988d8c32194b27014660c5f772c84896">Position</a> approach_center = base_center - 0.04*approach;</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    <span class="keyword">const</span> Eigen::Vector3d finger_lwh(hand_geometry.<a class="code" href="structHandGeometry.html#a73edbc1f059f2b1dbba4d8420f55786a">depth</a>, hand_geometry.<a class="code" href="structHandGeometry.html#a8001d8123f84378ebb7f9b8b26ddb348">finger_width</a>, hand_geometry.<a class="code" href="structHandGeometry.html#a73161921690601ba5bcacd3969edb877">height</a>);</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <span class="keyword">const</span> Eigen::Vector3d approach_lwh(0.08, hand_geometry.<a class="code" href="structHandGeometry.html#a8001d8123f84378ebb7f9b8b26ddb348">finger_width</a>, hand_geometry.<a class="code" href="structHandGeometry.html#a73161921690601ba5bcacd3969edb877">height</a>);</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    <a class="code" href="custom__types_8h.html#acf357236408d7f2041a5a46d8299f2d1">Rotation</a> rotation_mod;</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    rotation_mod.col(0) = approach;</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    rotation_mod.col(1) = binormal;</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    rotation_mod.col(2) = axis;</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    <span class="keyword">const</span> visualization_msgs::Marker base = <a class="code" href="classVisualizer.html#a5514e4570ce816e81c8f504f7242fc2f">createHandBaseMarker</a>(left_bottom, right_bottom, rotation_mod, 0.02, hand_geometry.<a class="code" href="structHandGeometry.html#a73161921690601ba5bcacd3969edb877">height</a>, 1, <span class="stringliteral">&quot;world&quot;</span>);</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <span class="keyword">const</span> visualization_msgs::Marker left_finger = <a class="code" href="classVisualizer.html#ae74e1da41969119e5c9c2f589091d088">createFingerMarker</a>(left_center, rotation_mod, finger_lwh, 2, <span class="stringliteral">&quot;world&quot;</span>);</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <span class="keyword">const</span> visualization_msgs::Marker right_finger = <a class="code" href="classVisualizer.html#ae74e1da41969119e5c9c2f589091d088">createFingerMarker</a>(right_center, rotation_mod, finger_lwh, 3, <span class="stringliteral">&quot;world&quot;</span>);</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    <span class="keyword">const</span> visualization_msgs::Marker appr = <a class="code" href="classVisualizer.html#ae74e1da41969119e5c9c2f589091d088">createFingerMarker</a>(approach_center, rotation_mod, approach_lwh, 4, <span class="stringliteral">&quot;world&quot;</span>);</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    visualization_msgs::MarkerArray marker_array;</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    marker_array.markers.push_back(left_finger);</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    marker_array.markers.push_back(right_finger);</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    marker_array.markers.push_back(appr);</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    marker_array.markers.push_back(base);</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <span class="keywordflow">return</span> marker_array;</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;}</div><div class="line"><a name="l00136"></a><span class="lineno"><a class="line" href="classVisualizer.html#ae74e1da41969119e5c9c2f589091d088">  136</a></span>&#160;visualization_msgs::Marker <a class="code" href="classVisualizer.html#ae74e1da41969119e5c9c2f589091d088">Visualizer::createFingerMarker</a>(<span class="keyword">const</span> <a class="code" href="custom__types_8h.html#a988d8c32194b27014660c5f772c84896">Position</a>&amp; center, <span class="keyword">const</span> <a class="code" href="custom__types_8h.html#acf357236408d7f2041a5a46d8299f2d1">Rotation</a>&amp; rotation, <span class="keyword">const</span> Eigen::Vector3d&amp; lwh, <span class="keywordtype">int</span> <span class="keywordtype">id</span>, <span class="keyword">const</span> std::string&amp; frame_id)</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;{</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    visualization_msgs::Marker marker;</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    marker.header.frame_id = frame_id;</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    marker.header.stamp = ros::Time();</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    marker.ns = <span class="stringliteral">&quot;finger&quot;</span>;</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    marker.id = id;</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    marker.type = visualization_msgs::Marker::CUBE;</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    marker.action = visualization_msgs::Marker::ADD;</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    tf::pointEigenToMsg(center, marker.pose.position);</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    tf::quaternionEigenToMsg(Eigen::Quaterniond(rotation), marker.pose.orientation);</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    marker.scale.x = lwh(0);</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    marker.scale.y = lwh(1);</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    marker.scale.z = lwh(2);</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    </div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    marker.color.r = 0.5;</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    marker.color.g = 0.0;</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    marker.color.b = 0.9;</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    marker.color.a = 0.9;</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    <span class="keywordflow">return</span> marker;</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;}</div><div class="line"><a name="l00160"></a><span class="lineno"><a class="line" href="classVisualizer.html#a5514e4570ce816e81c8f504f7242fc2f">  160</a></span>&#160;visualization_msgs::Marker <a class="code" href="classVisualizer.html#a5514e4570ce816e81c8f504f7242fc2f">Visualizer::createHandBaseMarker</a>(<span class="keyword">const</span> <a class="code" href="custom__types_8h.html#a988d8c32194b27014660c5f772c84896">Position</a>&amp; start, <span class="keyword">const</span> <a class="code" href="custom__types_8h.html#a988d8c32194b27014660c5f772c84896">Position</a>&amp; end, <span class="keyword">const</span> <a class="code" href="custom__types_8h.html#acf357236408d7f2041a5a46d8299f2d1">Rotation</a>&amp; rotation, <span class="keywordtype">double</span> length, <span class="keywordtype">double</span> height, <span class="keywordtype">int</span> <span class="keywordtype">id</span>, <span class="keyword">const</span> std::string&amp; frame_id)</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;{</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    Eigen::Vector3d center = start + 0.5 * (end - start);</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    visualization_msgs::Marker marker;</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    marker.header.frame_id = frame_id;</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    marker.header.stamp = ros::Time();</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    marker.ns = <span class="stringliteral">&quot;hand_base&quot;</span>;</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    marker.id = id;</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    marker.type = visualization_msgs::Marker::CUBE;</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    marker.action = visualization_msgs::Marker::ADD;</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    tf::pointEigenToMsg(center, marker.pose.position);</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    tf::quaternionEigenToMsg(Eigen::Quaterniond(rotation), marker.pose.orientation);</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    marker.scale.x = length;</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    marker.scale.y = (end - start).norm();</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    marker.scale.z = height;</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160; </div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    marker.color.r = 0.5;</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    marker.color.g = 0.0;</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    marker.color.b = 0.9;</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    marker.color.a = 0.9;</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <span class="keywordflow">return</span> marker;</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;}</div><div class="ttc" id="structPose_html_a6fd2cf5eb9fa60e6971f5cc7b7dcbdfd"><div class="ttname"><a href="structPose.html#a6fd2cf5eb9fa60e6971f5cc7b7dcbdfd">Pose::rotation</a></div><div class="ttdeci">Rotation rotation</div><div class="ttdef"><b>Definition:</b> <a href="custom__types_8h_source.html#l00024">custom_types.h:24</a></div></div>
<div class="ttc" id="visualizer_8cpp_html_ad86358bf19927183dd7b4ae215a29731"><div class="ttname"><a href="visualizer_8cpp.html#ad86358bf19927183dd7b4ae215a29731">COLOR_RED</a></div><div class="ttdeci">#define COLOR_RED</div><div class="ttdef"><b>Definition:</b> <a href="visualizer_8cpp_source.html#l00005">visualizer.cpp:5</a></div></div>
<div class="ttc" id="classVisualizer_html_a1b17f39ec85ad5238d414f18f609325b"><div class="ttname"><a href="classVisualizer.html#a1b17f39ec85ad5238d414f18f609325b">Visualizer::visual_tools_</a></div><div class="ttdeci">static moveit_visual_tools::MoveItVisualToolsPtr visual_tools_</div><div class="ttdef"><b>Definition:</b> <a href="visualizer_8h_source.html#l00117">visualizer.h:117</a></div></div>
<div class="ttc" id="structHandGeometry_html_a43487c0a1eed3549174d0018257b60d8"><div class="ttname"><a href="structHandGeometry.html#a43487c0a1eed3549174d0018257b60d8">HandGeometry::outer_diameter</a></div><div class="ttdeci">double outer_diameter</div><div class="ttdef"><b>Definition:</b> <a href="custom__types_8h_source.html#l00033">custom_types.h:33</a></div></div>
<div class="ttc" id="visualizer_8h_html"><div class="ttname"><a href="visualizer_8h.html">visualizer.h</a></div></div>
<div class="ttc" id="classVisualizer_html_a0b5176ec8358c54968c1738f0555157c"><div class="ttname"><a href="classVisualizer.html#a0b5176ec8358c54968c1738f0555157c">Visualizer::plotGrasp</a></div><div class="ttdeci">static void plotGrasp(const Pose &amp;pose, const HandGeometry &amp;hand_geometry, const double tcp_offset)</div><div class="ttdef"><b>Definition:</b> <a href="visualizer_8cpp_source.html#l00028">visualizer.cpp:28</a></div></div>
<div class="ttc" id="classVisualizer_html_ae74e1da41969119e5c9c2f589091d088"><div class="ttname"><a href="classVisualizer.html#ae74e1da41969119e5c9c2f589091d088">Visualizer::createFingerMarker</a></div><div class="ttdeci">static visualization_msgs::Marker createFingerMarker(const Position &amp;center, const Rotation &amp;rotation, const Eigen::Vector3d &amp;lwh, int id, const std::string &amp;frame_id)</div><div class="ttdef"><b>Definition:</b> <a href="visualizer_8cpp_source.html#l00136">visualizer.cpp:136</a></div></div>
<div class="ttc" id="visualizer_8cpp_html_a23c70d699a5a775bc2e1ebeb8603f630"><div class="ttname"><a href="visualizer_8cpp.html#a23c70d699a5a775bc2e1ebeb8603f630">COLOR_BLUE</a></div><div class="ttdeci">#define COLOR_BLUE</div><div class="ttdef"><b>Definition:</b> <a href="visualizer_8cpp_source.html#l00007">visualizer.cpp:7</a></div></div>
<div class="ttc" id="classVisualizer_html_a114a87e73b15235d8149ae3570927ef0"><div class="ttname"><a href="classVisualizer.html#a114a87e73b15235d8149ae3570927ef0">Visualizer::plotTrajectory</a></div><div class="ttdeci">static void plotTrajectory(const moveit_msgs::RobotTrajectory &amp;traj, const robot_model::JointModelGroup *joint_model_group)</div><div class="ttdef"><b>Definition:</b> <a href="visualizer_8cpp_source.html#l00035">visualizer.cpp:35</a></div></div>
<div class="ttc" id="structHandGeometry_html_a8001d8123f84378ebb7f9b8b26ddb348"><div class="ttname"><a href="structHandGeometry.html#a8001d8123f84378ebb7f9b8b26ddb348">HandGeometry::finger_width</a></div><div class="ttdeci">double finger_width</div><div class="ttdef"><b>Definition:</b> <a href="custom__types_8h_source.html#l00034">custom_types.h:34</a></div></div>
<div class="ttc" id="classVisualizer_html_a4f62c8d276bab5c3eb17286c24ade8df"><div class="ttname"><a href="classVisualizer.html#a4f62c8d276bab5c3eb17286c24ade8df">Visualizer::pub_vis_</a></div><div class="ttdeci">static ros::Publisher pub_vis_</div><div class="ttdef"><b>Definition:</b> <a href="visualizer_8h_source.html#l00113">visualizer.h:113</a></div></div>
<div class="ttc" id="structPose_html"><div class="ttname"><a href="structPose.html">Pose</a></div><div class="ttdef"><b>Definition:</b> <a href="custom__types_8h_source.html#l00022">custom_types.h:22</a></div></div>
<div class="ttc" id="classVisualizer_html_ad87e03ba0bb411c177f85f919ad48576"><div class="ttname"><a href="classVisualizer.html#ad87e03ba0bb411c177f85f919ad48576">Visualizer::init</a></div><div class="ttdeci">static void init(ros::NodeHandle &amp;node_handle)</div><div class="ttdef"><b>Definition:</b> <a href="visualizer_8cpp_source.html#l00012">visualizer.cpp:12</a></div></div>
<div class="ttc" id="structHandGeometry_html_a73edbc1f059f2b1dbba4d8420f55786a"><div class="ttname"><a href="structHandGeometry.html#a73edbc1f059f2b1dbba4d8420f55786a">HandGeometry::depth</a></div><div class="ttdeci">double depth</div><div class="ttdef"><b>Definition:</b> <a href="custom__types_8h_source.html#l00031">custom_types.h:31</a></div></div>
<div class="ttc" id="structHandGeometry_html"><div class="ttname"><a href="structHandGeometry.html">HandGeometry</a></div><div class="ttdef"><b>Definition:</b> <a href="custom__types_8h_source.html#l00030">custom_types.h:30</a></div></div>
<div class="ttc" id="structHandGeometry_html_a73161921690601ba5bcacd3969edb877"><div class="ttname"><a href="structHandGeometry.html#a73161921690601ba5bcacd3969edb877">HandGeometry::height</a></div><div class="ttdeci">double height</div><div class="ttdef"><b>Definition:</b> <a href="custom__types_8h_source.html#l00032">custom_types.h:32</a></div></div>
<div class="ttc" id="classVisualizer_html_aa37b51843fc787cc53457015fdcf921c"><div class="ttname"><a href="classVisualizer.html#aa37b51843fc787cc53457015fdcf921c">Visualizer::createGraspMarkers</a></div><div class="ttdeci">static visualization_msgs::MarkerArray createGraspMarkers(const Position &amp;position, const Rotation &amp;rotation, const HandGeometry &amp;hand_geometry)</div><div class="ttdef"><b>Definition:</b> <a href="visualizer_8cpp_source.html#l00098">visualizer.cpp:98</a></div></div>
<div class="ttc" id="visualizer_8cpp_html_afc9149f5de51bd9ac4f5ebbfa153f018"><div class="ttname"><a href="visualizer_8cpp.html#afc9149f5de51bd9ac4f5ebbfa153f018">COLOR_GREEN</a></div><div class="ttdeci">#define COLOR_GREEN</div><div class="ttdef"><b>Definition:</b> <a href="visualizer_8cpp_source.html#l00006">visualizer.cpp:6</a></div></div>
<div class="ttc" id="custom__types_8h_html_acf357236408d7f2041a5a46d8299f2d1"><div class="ttname"><a href="custom__types_8h.html#acf357236408d7f2041a5a46d8299f2d1">Rotation</a></div><div class="ttdeci">Eigen::Matrix3d Rotation</div><div class="ttdef"><b>Definition:</b> <a href="custom__types_8h_source.html#l00017">custom_types.h:17</a></div></div>
<div class="ttc" id="structPose_html_aae8ae43d254398d6e006032ae4ef72b1"><div class="ttname"><a href="structPose.html#aae8ae43d254398d6e006032ae4ef72b1">Pose::position</a></div><div class="ttdeci">Position position</div><div class="ttdef"><b>Definition:</b> <a href="custom__types_8h_source.html#l00023">custom_types.h:23</a></div></div>
<div class="ttc" id="classVisualizer_html_ac19c0f4fae081a121c586066830961cf"><div class="ttname"><a href="classVisualizer.html#ac19c0f4fae081a121c586066830961cf">Visualizer::createPoseMarkers</a></div><div class="ttdeci">static visualization_msgs::MarkerArray createPoseMarkers(const Position &amp;position, const Rotation &amp;rotation)</div><div class="ttdef"><b>Definition:</b> <a href="visualizer_8cpp_source.html#l00056">visualizer.cpp:56</a></div></div>
<div class="ttc" id="custom__types_8h_html_a988d8c32194b27014660c5f772c84896"><div class="ttname"><a href="custom__types_8h.html#a988d8c32194b27014660c5f772c84896">Position</a></div><div class="ttdeci">Eigen::Vector3d Position</div><div class="ttdef"><b>Definition:</b> <a href="custom__types_8h_source.html#l00013">custom_types.h:13</a></div></div>
<div class="ttc" id="classVisualizer_html_a5f586c3b071c50a15c4ccafeee285ada"><div class="ttname"><a href="classVisualizer.html#a5f586c3b071c50a15c4ccafeee285ada">Visualizer::plotPose</a></div><div class="ttdeci">static void plotPose(const Pose &amp;pose, const double tcp_offset)</div><div class="ttdef"><b>Definition:</b> <a href="visualizer_8cpp_source.html#l00021">visualizer.cpp:21</a></div></div>
<div class="ttc" id="classVisualizer_html_a0b07e74574ce90969bf0a78b8ab4124d"><div class="ttname"><a href="classVisualizer.html#a0b07e74574ce90969bf0a78b8ab4124d">Visualizer::createAxisMarker</a></div><div class="ttdeci">static visualization_msgs::Marker createAxisMarker(const Position &amp;origin, const Position &amp;direction, const Eigen::Vector4f &amp;color, int id, const std::string &amp;frame_id)</div><div class="ttdef"><b>Definition:</b> <a href="visualizer_8cpp_source.html#l00070">visualizer.cpp:70</a></div></div>
<div class="ttc" id="classVisualizer_html_acfb5b9aa985915dee7d8c63867e3259d"><div class="ttname"><a href="classVisualizer.html#acfb5b9aa985915dee7d8c63867e3259d">Visualizer::clear</a></div><div class="ttdeci">static void clear()</div><div class="ttdef"><b>Definition:</b> <a href="visualizer_8cpp_source.html#l00042">visualizer.cpp:42</a></div></div>
<div class="ttc" id="classVisualizer_html_a5514e4570ce816e81c8f504f7242fc2f"><div class="ttname"><a href="classVisualizer.html#a5514e4570ce816e81c8f504f7242fc2f">Visualizer::createHandBaseMarker</a></div><div class="ttdeci">static visualization_msgs::Marker createHandBaseMarker(const Position &amp;start, const Position &amp;end, const Rotation &amp;rotation, double length, double height, int id, const std::string &amp;frame_id)</div><div class="ttdef"><b>Definition:</b> <a href="visualizer_8cpp_source.html#l00160">visualizer.cpp:160</a></div></div>
</div><!-- fragment --></div><!-- contents -->

<br clear="all" />
<hr size="1"><div style="align: right;">
<a href="http://wiki.ros.org/panda_bin_picking">panda_bin_picking</a><br />
Author(s): David Leonhardt <david.leonhardt@stud.h-da.de></br />
<small>autogenerated on Sun Jul 4 2021 16:59:17</small>
</div>
</body>
</html>
